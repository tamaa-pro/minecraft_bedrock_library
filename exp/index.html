<!DOCTYPE html><html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>محرر HTML</title>
  <style>
    body {
      margin: 0;
      background-color: #444;
      height: 100vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      font-family: sans-serif;
    }#editor {
  flex: 1;
  display: flex;
  flex-direction: column;
  padding: 10px;
  box-sizing: border-box;
}

textarea {
  flex: 1;
  resize: none;
  background-color: #000;
  color: #fff;
  border: 2px solid #666;
  padding: 10px;
  font-family: monospace;
  font-size: 14px;
  direction: ltr;
  unicode-bidi: plaintext;
}

#toolbar {
  display: flex;
  justify-content: space-around;
  background-color: #333;
  padding: 5px;
}

#toolbar button, #bottom-buttons button {
  background: #666;
  color: white;
  border: none;
  padding: 8px;
  margin: 2px;
  cursor: pointer;
  border-radius: 5px;
}

#bottom-buttons {
  display: flex;
  justify-content: space-around;
  padding: 5px;
  background-color: #222;
}

iframe {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border: none;
  z-index: 9999;
  background: white;
}

.hidden {
  display: none;
}

  </style>
</head>
<body>
  <div id="editor">
    <div id="toolbar">
      <button onclick="setColor('white')">أبيض</button>
      <button onclick="setColor('black')">أسود</button>
      <button onclick="setColor('highlight')">ألوان مميزة</button>
      <button onclick="toggleLines()">شريط الترقيم</button>
      <input type="file" accept=".html" onchange="loadFile(event)">
      <button onclick="downloadCode()">حفظ كملف</button>
    </div>
    <textarea id="code" oninput="saveCode()"></textarea>
    <div id="bottom-buttons">
      <button onclick="copyCode()">نسخ</button>
      <button onclick="pasteCode()">لصق</button>
      <button onclick="clearCode()">حذف</button>
      <button onclick="undo()">رجوع</button>
      <button onclick="redo()">تقدم</button>
      <button onclick="runCode()">تشغيل</button>
    </div>
  </div>
  <iframe id="preview" class="hidden"></iframe>
  <script>
    const textarea = document.getElementById("code");
    const preview = document.getElementById("preview");
    let undoStack = [], redoStack = [];function saveCode() {
  localStorage.setItem("savedCode", textarea.value);
  undoStack.push(textarea.value);
}

function loadCode() {
  const saved = localStorage.getItem("savedCode");
  if (saved) textarea.value = saved;
}

function copyCode() {
  navigator.clipboard.writeText(textarea.value);
}

function pasteCode() {
  navigator.clipboard.readText().then(text => textarea.value += text);
}

function clearCode() {
  textarea.value = "";
  saveCode();
}

function undo() {
  if (undoStack.length > 1) {
    redoStack.push(undoStack.pop());
    textarea.value = undoStack[undoStack.length - 1];
  }
}

function redo() {
  if (redoStack.length) {
    const redoValue = redoStack.pop();
    textarea.value = redoValue;
    undoStack.push(redoValue);
  }
}

function runCode() {
  preview.classList.remove("hidden");
  preview.srcdoc = textarea.value;
}

function setColor(mode) {
  if (mode === 'white') {
    textarea.style.color = '#fff';
    textarea.style.backgroundColor = '#000';
  } else if (mode === 'black') {
    textarea.style.color = '#000';
    textarea.style.backgroundColor = '#fff';
  } else if (mode === 'highlight') {
    // بدائية مؤقتة لتلوين الكود
    alert('نمط الألوان المميزة غير مدعوم بعد');
  }
}

function toggleLines() {
  alert("ميزة شريط الترقيم قيد التطوير.");
}

function loadFile(event) {
  const reader = new FileReader();
  reader.onload = e => {
    textarea.value = e.target.result;
    saveCode();
  };
  reader.readAsText(event.target.files[0]);
}

function downloadCode() {
  const blob = new Blob([textarea.value], { type: 'text/html' });
  const link = document.createElement('a');
  link.download = 'code.html';
  link.href = URL.createObjectURL(blob);
  link.click();
}

loadCode();

  </script>
</body>
</html>
