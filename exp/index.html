<!DOCTYPE html><html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>محرر تاما</title>
  <style>
    body {
      background: #444;
      color: white;
      font-family: monospace;
      margin: 0;
      padding: 0;
      overflow: hidden;
    }
    #toolbar {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      background: #222;
      padding: 8px;
      justify-content: start;
      border-bottom: 1px solid #555;
    }
    #toolbar button, #colorSelect {
      padding: 5px 10px;
      background: #555;
      border: none;
      color: white;
      border-radius: 5px;
      cursor: pointer;
    }
    #toolbar button:hover, #colorSelect:hover {
      background: #666;
    }
    #editorContainer {
      display: flex;
      height: calc(100vh - 50px);
      overflow: hidden;
    }
    #lineNumbers {
      background: #333;
      color: #aaa;
      padding: 10px 5px;
      user-select: none;
      text-align: right;
    }
    #editor {
      flex: 1;
      padding: 10px;
      background: #444;
      color: white;
      outline: none;
      white-space: pre;
      overflow: auto;
      resize: none;
      font-family: monospace;
      direction: ltr;
    }
    #bottomTools {
      display: flex;
      justify-content: center;
      gap: 10px;
      padding: 5px;
      background: #222;
      border-top: 2px solid #111;
    }
    #bottomTools button {
      padding: 5px 10px;
      border-radius: 4px;
      border: none;
      background: #555;
      color: white;
    }
  </style>
</head>
<body>
  <div id="toolbar">
    <button onclick="copyText()">📋 نسخ</button>
    <button onclick="pasteText()">📥 لصق</button>
    <button onclick="deleteText()">🗑 حذف</button>
    <button onclick="undoText()">↩ تراجع</button>
    <button onclick="redoText()">↪ تقدم</button>
    <select id="colorSelect" onchange="changeColor(this.value)">
      <option value="white">أبيض</option>
      <option value="black">أسود</option>
      <option value="gray">رمادي</option>
      <option value="green">أخضر</option>
      <option value="github">مميز</option>
    </select>
    <button onclick="saveAsFile()">💾 حفظ كملف</button>
    <button onclick="openPreview()">▶️ تشغيل الكود</button>
  </div>  <div id="editorContainer">
    <div id="lineNumbers"></div>
    <pre id="editor" contenteditable oninput="updateLineNumbers(); autoSave();"></pre>
  </div>  <div id="bottomTools">
    <button onclick="copyText()">نسخ</button>
    <button onclick="pasteText()">لصق</button>
    <button onclick="deleteText()">حذف</button>
    <button onclick="undoText()">تراجع</button>
    <button onclick="redoText()">تقدم</button>
  </div>  <script>
    const editor = document.getElementById("editor");
    const lineNumbers = document.getElementById("lineNumbers");

    function updateLineNumbers() {
      const lines = editor.innerText.split("\n").length;
      lineNumbers.innerHTML = Array.from({length: lines}, (_, i) => (i+1)).join("<br>");
    }

    function autoSave() {
      localStorage.setItem("tamacode", editor.innerText);
    }

    function loadSaved() {
      const saved = localStorage.getItem("tamacode");
      if (saved) editor.innerText = saved;
      updateLineNumbers();
    }

    function copyText() {
      navigator.clipboard.writeText(editor.innerText);
    }
    function pasteText() {
      navigator.clipboard.readText().then(text => editor.innerText += text);
    }
    function deleteText() {
      editor.innerText = "";
      updateLineNumbers();
    }
    function undoText() { document.execCommand("undo"); }
    function redoText() { document.execCommand("redo"); }

    function changeColor(value) {
      if (value === "github") {
        editor.style.color = "#eee";
        editor.style.background = "#282c34";
      } else {
        editor.style.color = value;
        editor.style.background = "#444";
      }
    }

    function saveAsFile() {
      const blob = new Blob([editor.innerText], {type: "text/html"});
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "tamafile.html";
      a.click();
    }

    function openPreview() {
      const previewWin = window.open(location.href + "?p=view", "_blank");
      localStorage.setItem("tamaview", editor.innerText);
    }

    if (location.search.includes("p=view")) {
      document.body.innerHTML = localStorage.getItem("tamaview") || "<h1>لا يوجد كود لعرضه</h1>";
      const scriptTags = document.getElementsByTagName("script");
      for (let s of scriptTags) {
        const newScript = document.createElement("script");
        newScript.textContent = s.textContent;
        s.replaceWith(newScript);
      }
    } else {
      loadSaved();
    }
  </script></body>
</html>
