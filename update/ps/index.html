<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>تحميل المكتبة</title>

<style>
body{
 background:#0f0f12;
 color:#fff;
 font-family:system-ui;
 display:flex;
 justify-content:center;
 align-items:center;
 height:100vh;
 margin:0
}
.card{
 background:#18181c;
 padding:25px;
 border-radius:18px;
 width:340px;
 box-shadow:0 10px 40px rgba(0,0,0,.6)
}
.top{
 display:flex;
 gap:15px;
 align-items:center
}
.iconBox{
 position:relative;
 width:90px;
 height:90px
}
.iconBox img{
 width:100%;
 height:100%;
 border-radius:22px
}
svg{
 position:absolute;
 top:0;
 left:0;
 transform:rotate(-90deg)
}
circle{
 fill:none;
 stroke-width:6
}
.bg{
 stroke:#2a2a2f
}
.progress{
 stroke:#3ddc84;
 stroke-dasharray:283;
 stroke-dashoffset:283;
 stroke-linecap:round;
 transition:stroke-dashoffset .2s linear
}
.percent{
 position:absolute;
 inset:0;
 display:flex;
 justify-content:center;
 align-items:center;
 font-size:14px;
 font-weight:bold
}
.info h2{
 margin:0;
 font-size:18px
}
.info span{
 font-size:13px;
 color:#aaa
}
button{
 width:100%;
 margin-top:20px;
 padding:12px;
 border:none;
 border-radius:12px;
 font-size:15px;
 font-weight:bold;
 cursor:pointer;
 transition:.2s
}
.download{
 background:#3ddc84;
 color:#000
}
.disabled{
 background:#2a2a2f;
 color:#666;
 cursor:not-allowed
}
.install{
 background:#2962ff
}
</style>
</head>
<body>

<div class="card">

 <div class="top">
  <div class="iconBox">
   <img src="https://tamaa-pro.github.io/minecraft_bedrock_library/data/screenshots/library_icon.png">
   <svg width="90" height="90">
    <circle class="bg" cx="45" cy="45" r="45"/>
    <circle id="progress" class="progress" cx="45" cy="45" r="45"/>
   </svg>
   <div id="percent" class="percent"></div>
  </div>
  <div class="info">
   <h2>المكتبة</h2>
   <span>الإصدار 2.7</span><br>
   <span>25 فبراير 2026</span>
  </div>
 </div>

 <button id="btn" class="download">تحميل</button>

</div>

<script>
const url="https://github.com/tamaa-pro/minecraft_bedrock_library/releases/download/v2.7/library.apk";
const btn=document.getElementById("btn");
const progressCircle=document.getElementById("progress");
const percentText=document.getElementById("percent");
const totalLength=283;
let blobUrl=null;

btn.onclick=async()=>{
 btn.classList.remove("download");
 btn.classList.add("disabled");
 btn.innerText="جارٍ التحميل...";
 btn.disabled=true;

 const response=await fetch(url);
 const reader=response.body.getReader();
 const contentLength=+response.headers.get("Content-Length");
 let received=0;
 let chunks=[];

 while(true){
  const {done,value}=await reader.read();
  if(done)break;
  chunks.push(value);
  received+=value.length;
  let percent=Math.floor((received/contentLength)*100);
  let offset=totalLength-(percent/100)*totalLength;
  progressCircle.style.strokeDashoffset=offset;
  percentText.innerText=percent+"%";
 }

 const blob=new Blob(chunks);
 blobUrl=URL.createObjectURL(blob);

 btn.classList.remove("disabled");
 btn.classList.add("install");
 btn.innerText="تثبيت";
 btn.disabled=false;

 btn.onclick=()=>{
  const a=document.createElement("a");
  a.href=blobUrl;
  a.download="library.apk";
  a.click();
 };
};
</script>

</body>
</html>
